/*!CK:2327731967!*//*1400798595,178167347*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Xu6wE"]); }

__d("SearchFunnelTypeaheadLogger",["Banzai","Event","PageTransitions","SubscriptionsHandler"],function(a,b,c,d,e,f,g,h,i,j){var k='search_funnel',l={init:function(m,n){if(!m)return;this._shouldRetry=n;this._core=m.getCore();this._data=m.getData();this._view=m.getView();this._handler=new j();this.log=this.log.bind(this);this.onKeydown=this.onKeydown.bind(this);this.onSelect=this.onSelect.bind(this);this.onTypeaheadImpression=this.onTypeaheadImpression.bind(this);this._transitionInProgress=true;this.onTypeaheadImpression();},onTypeaheadImpression:function(m){if(this._transitionInProgress)this.log('impression',{funnel_path:i.getNextURI().path});this.reset();this._handler.addSubscriptions(this._core.subscribeOnce('focus',this.log),this._view.subscribeOnce('render',this.log),this._view.subscribeOnce('select',this.onSelect));h.listen(this._core.getElement(),'keydown',this.onKeydown);i.registerHandler(function(){this._transitionInProgress=true;}.bind(this));i.registerCompletionCallback(this.onTypeaheadImpression);},onKeydown:function(event){if(!this._sawKeydown){this._sawKeydown=true;this.log('keydown',event);}},onSelect:function(event,m){m.funnel_data={selected_position:m.selected.globalIndex,selected_type:m.selected.type};if(m.selected.isNullState){m.funnel_data.interaction_type='null_state';}else if(m.selected.isSingleState){m.funnel_data.interaction_type='single_state';}else m.funnel_data.interaction_type='typed';this.log(event,m);},reset:function(){this._handler.release();this._handler.engage();this._sawKeydown=false;this._transitionInProgress=false;},log:function(m,n){n=n||{};n.funnel_data=n.funnel_data||{};n.funnel_data.current_event_time=Date.now();if(this._prevTime&&this._prevEvt){n.funnel_data.previous_event_time=this._prevTime;n.funnel_data.previous_event=this._prevEvt;}this._prevTime=n.funnel_data.current_event_time;this._prevEvt=m;g.post(k,{funnel_data:n.funnel_data,path:n.funnel_path||i.getMostRecentURI().path,stage:m},this._shouldRetry?g.VITAL:{});}};e.exports=l;});
__d("TypeaheadRecentSearchUpdater",["Arbiter"],function(a,b,c,d,e,f,g){function h(i){"use strict";this.view=i.getView();}h.prototype.enable=function(){"use strict";this.updaterSubscription=this.view.subscribe('select',function(){g.inform('search/refreshRecentSearchesNullstate',{},g.BEHAVIOR_STATE);});};h.prototype.disable=function(){"use strict";this.view.unsubscribe(this.updaterSubscription);};e.exports=h;});